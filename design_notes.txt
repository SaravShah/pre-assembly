# TODO: Modify boot.rb and pre-assembly.rb to rationalize requires.
# TODO: deployment cap task.
# TODO: modify code generating desc_metadata.xml (waiting for REVS MODS spec).

# TODO: reevaluate logging for use in deployed context.
# TODO: consider whether to persist information about druids processed.
# TODO: Modify revs.yaml when we start using for real.
# TODO: rdoc documentation and README.
# TODO: refactor to handle DPG content.


Receive bundle of materials (manual):

    - Receive the bundle of material (e.g. REVS hard drive).
    - Copy the bundle to a prep area on the thumper staging machine.
    - Launch the pre-assembly process.


Pre-assembly (automated):

    # Load information from the data provider.
    - Expected checksum metadata.
    - Manifest.

    For each digital object:

        - Register the object and acquire a druid.
        - Copy the object to a druid tree in thumper staging directory.
        - Generate content_metadata.xml.
        - Generate desc_metadata.xml.
        - Initialize the object's assemblyWF in DOR (a REST call).

        - Later: get descriptive metadata from other souces, such as mdtoolkit
          and symphony.


Notes on the require flow:

    bin/pre-assemble
        
        require rubygems     # Remove this.

        require boot

            require rubygems              # Repeat.
            require logger

            Set ROBOT_ENVIRONMENT

            require solrizer
            require dor-services
            require lyber_core

            require ENV_FILE              # Just Dor::Config.

            Add lib to LOAD_PATH

            require pre-assembly/logging

            require pre-assembly

                require csv-mapper
                require fileutils
                require yaml

                require pre-assembly/version
                require pre-assembly/bundle
                require pre-assembly/digital_object
                require pre-assembly/image

    spec/spec_helper.rb

        require tmpdir
        require equivalent-xml

        Set ROBOT_ENVIRONMENT

        require bootfile  # See above.


    Alternative approach:

        - Move boot.rb code into pre-assembly.rb.

        - Usage in scripts (in deployed context).

            # User needs to activate the appropriate rvm gemset (deployed-pre-assembly).

            require rubygems
            require pre-assembly # As a gem?
            b.Bundle.new ...

        - Usage in scripts (during local development).

            require rubygems
            require testing gems
            require lib/pre-assembly.rb

        - Usage in tests.

            require rubygems
            require testing gems
            require lib/pre-assembly.rb
