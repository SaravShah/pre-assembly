#! /usr/bin/env ruby

require File.expand_path(File.dirname(__FILE__) + '/../config/boot')

repo      = 'dor'
wf        = 'assemblyWF'
msg       = 'Integration testing'
wfs       = Dor::WorkflowService
steps     = Dor::Config.pre_assembly.assembly_wf_steps.map { |s| s[0] }
completed = steps[0]

steps.each do |waiting|
  druids = wfs.get_objects_for_workstep completed, waiting, repo, wf
  druids.each do |dru|
    params = [repo, dru, wf, waiting, msg]
    resp = wfs.update_workflow_error_status *params
    puts "updated: resp=#{resp} params=#{params.inspect}"
  end
end
